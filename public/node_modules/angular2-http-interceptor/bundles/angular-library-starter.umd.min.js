(function(global,factory){typeof exports==="object"&&typeof module!=="undefined"?factory(exports,require("rxjs"),require("@angular/core"),require("@angular/http")):typeof define==="function"&&define.amd?define(["exports","rxjs","@angular/core","@angular/http"],factory):factory((global.ng=global.ng||{},global.ng["angular-library-starter"]=global.ng["angular-library-starter"]||{}),global.rxjs,global.ng.core,global._angular_http)})(this,function(exports,rxjs,_angular_core,_angular_http){"use strict";var HttpInterceptor=function(){function HttpInterceptor(){}HttpInterceptor.prototype.before=function(request){return request};HttpInterceptor.prototype.after=function(res){return res};return HttpInterceptor}();var HttpInterceptorConnection=function(){function HttpInterceptorConnection(requestObservable,xhrBackend){var _this=this;this.response=new rxjs.Observable(function(responseObserver){_this.subscription=requestObservable.subscribe(function(req){_this.request=req;var xhrConnection=xhrBackend.createConnection(req);xhrConnection.response.subscribe(function(response){return responseObserver.next(response)},function(error){return responseObserver.error(error)},function(){return responseObserver.complete()})},function(error){return console.error(error)})})}return HttpInterceptorConnection}();var HttpInterceptorBackend=function(){function HttpInterceptorBackend(httpInterceptors,xhrBackend){this.httpInterceptors=httpInterceptors;this.xhrBackend=xhrBackend}HttpInterceptorBackend.prototype.createConnection=function(request){var reqObs=rxjs.Observable.of(request);var _loop_1=function(interceptor){if(!interceptor.before){return"continue"}reqObs=reqObs.mergeMap(function(req){var nextReq=interceptor.before(req);return nextReq instanceof rxjs.Observable?nextReq:rxjs.Observable.of(nextReq)})};for(var _i=0,_a=this.httpInterceptors;_i<_a.length;_i++){var interceptor=_a[_i];_loop_1(interceptor)}var connection=new HttpInterceptorConnection(reqObs,this.xhrBackend);this.httpInterceptors.forEach(function(interceptor){if(interceptor.after){connection.response=interceptor.after(connection.response)}});return connection};return HttpInterceptorBackend}();function httpFactory(httpInterceptorBackend,requestOptions){return new _angular_http.Http(httpInterceptorBackend,requestOptions)}function createDefaultCookieXSRFStrategy(){return new _angular_http.CookieXSRFStrategy}var HttpInterceptorModule=function(){function HttpInterceptorModule(){}HttpInterceptorModule.withInterceptors=function(interceptors){return{ngModule:HttpInterceptorModule,providers:interceptors.concat([{deps:[HttpInterceptor,_angular_http.XHRBackend],provide:HttpInterceptorBackend,useClass:HttpInterceptorBackend},{deps:[HttpInterceptorBackend,_angular_http.RequestOptions],provide:_angular_http.Http,useFactory:httpFactory},_angular_http.BrowserXhr,{provide:_angular_http.RequestOptions,useClass:_angular_http.BaseRequestOptions},{provide:_angular_http.ResponseOptions,useClass:_angular_http.BaseResponseOptions},_angular_http.XHRBackend,{provide:_angular_http.XSRFStrategy,useFactory:createDefaultCookieXSRFStrategy}])}};HttpInterceptorModule.decorators=[{type:_angular_core.NgModule}];HttpInterceptorModule.ctorParameters=function(){return[]};return HttpInterceptorModule}();exports.HttpInterceptor=HttpInterceptor;exports.HttpInterceptorBackend=HttpInterceptorBackend;exports.HttpInterceptorConnection=HttpInterceptorConnection;exports.HttpInterceptorModule=HttpInterceptorModule;Object.defineProperty(exports,"__esModule",{value:true})});